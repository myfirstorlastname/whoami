<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Path Traversal</title>
  <link rel="stylesheet" href="https://myfirstorlastname.github.io/whoami/style.css" />
</head>
<body>
  <div id="toc-container"></div>

  <h1>Path Traversal</h1>
  <blockquote>
    "A single <code>../</code> can turn an image loader into a system explorer."
  </blockquote>

  <h2>Introduction</h2>
  <p>
    Path Traversal (also called <em>Directory Traversal</em>) is a vulnerability that lets an attacker
    manipulate file paths to access resources the application did not intend to expose.
    By abusing sequences such as <code>../</code>, an attacker can escape the intended directory
    and read or even execute sensitive files on the server.
  </p>

  <h2>Offensive perspective</h2>
  <p>
    The primary goal of an attacker is to turn a simple file-loading feature (images, templates, logs, etc.)
    into an entry point to critical files such as <code>/etc/passwd</code>, <code>web.config</code>, or private keys.
  </p>
  <p>
    The technique relies on improper input validation. Common bypass techniques include:
  </p>
  <ul>
    <li><strong>Multiple encodings</strong>: <code>%2e%2e/</code>, <code>..%2f</code></li>
    <li><strong>Double decoding</strong> to force re-interpretation of the path</li>
    <li><strong>Null-byte injection</strong> (<code>%00</code>) to bypass extension checks</li>
    <li><strong>Absolute path prefixes</strong> (e.g. <code>/etc/passwd</code>) to bypass naive filters</li>
  </ul>

  <h2>Practical examples</h2>

  <h3>1. Simple case</h3>
  <p>
    If the application loads a file via:  
    <code>GET /loadImage?file=cat.png</code>  
    → Injection: <code>?file=../../../../etc/passwd</code>  
    allows exfiltrating the system users list.
  </p>

  <h3>2. Absolute path bypass</h3>
  <p>
    When <code>../</code> sequences are filtered out, specifying an absolute path may work:  
    <code>?file=/etc/passwd</code>
  </p>

  <h3>3. Stripped non-recursively</h3>
  <p>
    Some filters remove forbidden sequences only <em>once</em>.  
    → Payload: <code>....//....//etc/passwd</code>  
    After a single removal, the resulting path becomes valid and points to <code>/etc/passwd</code>.
  </p>

  <h3>4. Double decoding</h3>
  <p>
    A naive decoder can be tricked by double-encoding:  
    <code>%252e%252e%252fetc/passwd</code>  
    is decoded twice into <code>../../etc/passwd</code>.
  </p>

  <h3>5. Null-byte injection</h3>
  <p>
    To bypass an extension check (e.g. requiring <code>.png</code>), an attacker may add a null byte:  
    <code>?file=../../etc/passwd%00.png</code>
  </p>

  <h2>Attacker objectives</h2>
  <ul>
    <li>Read sensitive files (<code>/etc/passwd</code>, <code>/etc/shadow</code>, <code>web.config</code>)</li>
    <li>Execute code by including server-side scripts</li>
    <li>Escalate to RCE via inclusion of application files or logs</li>
  </ul>

  <footer>
    Path Traversal shows how poor path validation can turn a harmless feature into a powerful exfiltration
    or code execution vector. Understanding these techniques and their bypasses is essential for any offensive tester.
  </footer>

  <script src="https://myfirstorlastname.github.io/whoami/call_for_toc.js"></script>
</body>
</html>
